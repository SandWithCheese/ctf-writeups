# This file was *autogenerated* from the file chall.sage
from sage.all_cmdline import *  # import sage library

_sage_const_10125587985639601441 = Integer(10125587985639601441)
_sage_const_1 = Integer(1)
_sage_const_12993409 = Integer(12993409)
_sage_const_812504336 = Integer(812504336)
_sage_const_2837429843 = Integer(2837429843)
_sage_const_1782093 = Integer(1782093)
_sage_const_256 = Integer(256)
flag = open("flag.txt", "rb").read().strip()
p = _sage_const_10125587985639601441
F = GF(p)
Q = QuaternionAlgebra(F, -_sage_const_1, -_sage_const_1)
i, j, k = Q.gens()
gen = (
    _sage_const_12993409
    + _sage_const_812504336 * i
    + _sage_const_2837429843 * j
    + _sage_const_1782093 * k
)
print(
    b"".join(
        list(
            map(
                lambda x, y: bytes([(int(x) ^ int(y)) % _sage_const_256]),
                flag,
                [(gen**idx) + (gen**idx).conjugate() for idx in range(len(flag))],
            )
        )
    ).hex()
)

# 41566653fa6f63b3f1bb3b639084a10b8cb95253c5117a7d990c16bd1ecfdd8de9c2857992cb6125eb97678f8a3c1c3caf48748aabbec1196a78a01ac05c74d0b64c48049be8116ceddebe
