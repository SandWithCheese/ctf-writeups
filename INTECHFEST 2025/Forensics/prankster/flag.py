import json
import binascii

# The log data as a list of JSON strings
log_lines = [
    '{"data":"ffb58d3b5d43c5f0efc18cb6d80070cd330decc8dd31fcfe6d4981b8f5e64882d5e3d0ee76dc46e9f509cd9aa40203f4f02d39da2012172db9475dc72cf57d3e612081d5e27d67b366f4977b54d317fd07dd4b69341af9fc98279dc9bce321ca7dceaf97654368c86f602efda8fb8fe64afe8008c2aac24a7b51291df7432b529ca461ee067cc2cd7b25481a5de106401cbe59455de16011db28b910e124193b1448ddc9e07332e0e943d232ab4b355225d060eeff6f894cd52375da0b4c24d49e7bfe985ad108485dbf9a92f156edc0b59ce1eb68daaf8f76ad3493af7e3f239d1ef6af243041608af105fe9879654dbf4b583c112bff4f7602","chunk":"0.txt.enc.000000"}',
    '{"data":"0753fd89136b68eb9d2548e4bf9218794a60c4375ba2d9d19c6e0d3f318f5eb4ffa38b95416ec1009a4398a45267a5b4592b95faf174cae4613aa88dc72dae3bdeb91c49baa29054700cf6384d24fae8d28730b4e42946f19b639b36feed69fb58c59ad1a9a3b9e06c43fd3bb4c8771c1b6a0d268ba6db30e1eccb5ba0deef9a468912c79047f9575f1c07dce2a13ff8030753527248611452b3a5c6c9ba0b7d46c310e33f37fa196096519053efcd330461a7c530b4a9577535ffcbac26fed84f75e05a520a91cb7eda3b32d25a971d62add5e3f422f5368a7969f3270dc44cf4cfe185aa7606397a6b65f10b28af26162cdc90c6fe418b22fb","chunk":"0.txt.enc.000001"}',
    '{"data":"1cf9df49d0e5debd0fd756729dce67ad66b7ffdd91a7f3fec11cd5688c7baeaf325697fcfd1bc1eca7b3c35a54384bcda3ef69e5a87cbd1d0ac7f0d49579fd8260d69336e443881c793c94852392a62e6962471f7e8a9e98cac01104fce89bdf0ab8c4c2ebdc9991c79f647ba14c6176a74694a71950467b1813011a2f471823cdc95a1dd1f69b6477c0f3f2ae333de7d2916791ea187ea8e9f51726bbbb2f20a5d7bcd8687630cb031ba8e24c20eae4d82979fb0233dfb84a4fb123ee9286562b6ca8900bad75fc3ed91fcce19531f65449f158d32f6b2b452468901b6404af084d11fafbd4e9713130c5e11200dfdfa8a19e0659d73ccbe44d","chunk":"0.txt.enc.000002"}',
    '{"data":"b67c74e47f7c69cf34589d3af3164517f8012a8e9182c0349abc08a00ce66fa85b56094e3db44e50cf62006c7f451706d0f98d4bb15f8af89c2fc834bcb757d62c70b2995257b39f90684f6f88d4f353605b7b78a753e5e20cd99a687c2d1af673c3373ed6a1bb3b9ccc93c11a459a87a68a9f0ddeca50622d982de9d01304718bb87723cfb8f357dde5b19889f94f98367129379a138e24d64118e5695bbc2b14b440d612b4123658544562f514729f216be5b7551634db09a275c456228821908e2c6cdbcb3fd716930a12d67d1908fb82cd9c034a7dcd3f2b75ae9284cda9d9da42ac90d18c8db70a4b4e24ca077bd1e0ad76d1772088ed8b","chunk":"0.txt.enc.000003"}',
    '{"data":"35574b0ec7494bcd53d8cb5aee7be246748525f7935af8a65af9ddb36eb7ecd083156e3dc58c804ac9153a6c88f50f23b0bcd8b14cda15a7343caaf23239197bf6781d3fd5b37b2ce4124b5d4332e654c4f2b4fa2d7709182aff5a1797758e94939c875bfae38e1c69acfb3f5c28918236e8460c4d12da475359b2e62fa354bcd6e3e901a43d8cbd9426b809a3601ae7cef6d0b2c84bdaedb378d168f240b440b312a01fcf6455754ba9c7b7fc3793d9beba2633f85312d571717f3519efd7ffe51de2eedf397ee47d97d8c49dab5fd7920b89123c178c2e8c75b8c69f60d0f70d67801f37520fe994061f933381f49cbeffae93d9e234bb9ed2","chunk":"0.txt.enc.000004"}',
    '{"data":"930772869045fbbd1d09d63b2f57041a592124bac8a6b41b24d0ccfda4d80417fd0a26b32f2dbf985cf9345da39b3df894f44f3efa521f0f612037efcdf07a797dae0adb53ea206daa0cd564e3dcd2abe62740dcd638c35085ac68f023e7cc485f89276e6351786f766cfb8f641d45029984d2dc23c145d7c556cdb75882659ebe0ede8c06f0e261356a3ebb163b903d6eb00b5f38d6069947d9264f1a4242a3d4246c5072ab85fc50c86a13c5697478fe130ec01ae0714f8740049f4f19b1b6ee227c9f489420ce43f849f5cf3e1146fc6b900038b8854bd6b7c61db95dc96fabd59d7cd49c772b7504ca9faf08b9c8fdeac500d2b83c3abf79","chunk":"0.txt.enc.000005"}',
    '{"data":"b55e12d74ef8e0a836e57f11a75e0ea5ebc0a6ab33d780439468a3394bbb6d573c2a5fa8695299ded4359f86e2c78e6d9818000748735bfeac14ff532d82b96179fdbf8e40c56c6963c43326542620bb38415ce84323593c51a222d3dc8b46fe000f969b25e9779e5fd7533df8fb343e50f44303f97adfcff3fe30746fb87efef38e51e279dbb2829a164307d20322b7a5607af8544d7ea9cf29cf133341c6e57ca9f5cbe44d41e38556e2e63c6804690a65321ab2576a11e91508025ec25c38ef77e0e34f861317faaa6ee36745f2b6968882321e030a70c483b8c0a5cd8e41bbde53d7aca683ad620041707912aec5fb3e85d9802b4ec90aae","chunk":"0.txt.enc.000006"}',
    '{"data":"51ca126482a83aca0eca0f0d1b4eadf006f29d87fa24d94c9fcfb29ab24f57e273d5ae9bf187afeb7a7de0394611bd76e9e03571338771547b15f570f4891abfed9d3717d43bbe440bf889a692dcaaea2be33e1414a0fca96e55f8f3b82b8735c94849a2e7d36fa6d01f5d870948c38214caeac9c006829128b547f0a1283d8071124326c8789cfd95116124961d01a84d7ae793b64123931c9e92c2feba99b92f125e5aea2d5cb7cf0511da2c45d07773a13f70e2f38baf21863594ac5f32fb97c2735fc916f5d50a18230a0bd15f675618e1f8876ee06bf5361a121933bb23779087d4195b83f055d6fbcf644c3b0c3d748c77860dac2649cd","chunk":"0.txt.enc.000007"}',
    '{"data":"c18a3a1a6ce8251630787e524dfb79a3a913b58139f06ea0b91d59687744dce39feeb979210454897ecb167f0d5af2006b4c193aa3a8319ec7e28fe8920126f432bee3fc567a45084be62a5b15d2eac8271d5b1af6da859d4b9a9c4aa1ddd621175273fe73c41c7fa2bb5485c32801fabee49c02c86493ed5f229c720b404aeaf20130403c98247d7a5f10c959b8dc66e18ec32eb8be8fb2e6d40dff2fa8ad88227d35996ef7831bdb0c233548f1bc6675c9a86ca51776dd52e5d382f737885de4216b71255ad8d8742c3af48b73ec726d5639fae2dabd5b6bb73dec2868962e80d521a9b1cbea2f6defbabaddd6c9db263e02c4b03bc8d9d998","chunk":"0.txt.enc.000008"}',
    '{"data":"819efc50d79f951da31761f92ea60f569b811f6473953416d7b1152a95fb4f581203f1c33eb44480576c1cf233793a472e15ff3d57e54b353a47975fa7c2da235ee82c64728dc3a38294e80c876b6cdc5f0f944b53b5f25f5d91910b44f7a9e50fd965dcd99c156c0610a142ebc1a55d5ebafb80f365e27b0dbe35b94aaab8ed1407750acc8ad9a4e06dd7bfcd9bc6d10570a4263cbab2d246ba61ee8dd5ef013caf485230cd3eef32045c00f3c1e7f5737c7c679d06d909735af5bed767a8c63d55a8723b49258ce0d5d0aa56bea595f0ec657deb51fd4731b361789e1fb9062f4078054b7b2fff4d9fc3cbf2ac0a005e4db0c8f95ae38b418c","chunk":"0.txt.enc.000009"}',
    '{"data":"8812d1503acee2103215c357fdf1b4f4112ac066752902ed91e934209849788e3d1e66598926cde5bcaae5f9360b5e5fd275b399045b6722b3770451f78d0a7400d05d75ab68f0665418d9ad302319e96a4c6467f48dc5a0b9473061be2a5e2851efc744ce5d3e230f655be66a7b8332703502f211185dff48342f0642dbb94075db3e901050550b7bcb9411382f0b6fddcd0d93f36e15c99c46dcb6b1a8d2383f530bfdf79cff25b5af746f090b82a05ecebd108a801eb18263c1a4deb011b3d54d892dac0bf825b9eec667059d12601469260a5d01e822167c81761aec4fb14d04f58bebd6565613792d68c6d6d0ee2bc971786fc206800886","chunk":"0.txt.enc.000010"}',
    '{"data":"5593b0c3cb6ed0cc5728fe9f51c248f0fb951e0fb7e63a59260c7641e668d9f84ad3db20823d39d5bee6f7558f7792c71bb352a277f2c4b9fc678844ca4b5b872f9d8d1d7051137fdcb2aeb4298dd48c8386c0ac388d574b1d23973ede0ee9c7535e46d26ab6b3195c7c379567038ab5bc0371fdbf240056e0a19256448ae0bdecb98070c8f4e6d5c3cb5fb5f43f555793f0eaedfa3386d88c35c8b9c553911950c2c808b56790bc25bc670de8e2c881743d6539c10be9e66a1d313220635d81374e22f7c02e14600a1909c8f253cffcb4058f99250c5210f852328ef5b4a4cfdce37c552cf1019e6ce9b2ce444e64086805e2226bde47f62fc7","chunk":"0.txt.enc.000011"}',
    '{"data":"85845458dd74c79f693d6c00989bc9fddf058f1daff06d31609e4db6732084c28b4d0cae4da3f38f7da12b158dbe676ea49165a212c844fff6e834a6ae94a47a97c7d278497854829070549d2f14092abcfffdba10106e497d3634476fa519a9bcedd43db645a835e25a3f4c7fb5cf6329201f5cfb12dcb81c533558e26e38f7a9ad8010fd855377dd030a7d28a1c01e00273749fd9e7d4032bcd7493323d8a945541431ee2187623da0a49a3ce91be005c70f4bc4354e377eb1d4e44daf74d1a96a6583a6a3bf4f9d7eada7eedd573aa998d9aadd722177f9f525d21a840b8cec1b139f25fbba7e53d0859689a648040e872bd745e8f791192d","chunk":"0.txt.enc.000012"}',
    '{"data":"29bbbbc5610055e726b7e5c135d1581a755c831e6e38cd72efca6bc5feb328ed3cd160e7b9adf69a210ac663a0a0ec636c42ef8b771f231de3e437e166ed89c3320f4f5310f87064712c3b50cee6b800687819fb943947f41943eb0824aced33ae39a1366cb7996176588240cf8f5abd52af22b1596095861b6a67ddfc1a436639edc22452ee90d1554cf8e108981b7d99fb7668813d2ffb5eccb8de8410540d8c643cdf60dbed258738985498f30c11542166bee8f3f7b26d92fb0571faf9ee067f2b469c4729715fa04d8bf824d9f30f43ed16d0259d4ffca7119cfc3e96d8309e124a94ad967b6e4d0c0b7578694a6466e19fb77e258e8a9a","chunk":"0.txt.enc.000013"}',
    '{"data":"f7e8f876d1b8bd6d7199b8511ea576a45d2400e7587d731870671b425c95059249fdd6ffa0","chunk":"0.txt.enc.000014"}',
]

# Parse each JSON object and extract chunk number and data
chunks = []
for line in log_lines:
    obj = json.loads(line)
    chunk_num = int(obj["chunk"].split(".")[-1])  # Get the number from the chunk name
    data_str = obj["data"]
    chunks.append((chunk_num, data_str))

# Sort chunks by chunk number
chunks.sort(key=lambda x: x[0])

# Step 1: For each chunk, reverse the data string to get the original hex of the chunk binary
hex_chunks = []
for chunk_num, data_str in chunks:
    # Reverse the hex string
    reversed_hex = data_str[::-1]  # This reverses the string
    hex_chunks.append(reversed_hex)

# Step 2: Convert each reversed hex string to bytes and concatenate
obfuscated_bytes = b""
for hex_str in hex_chunks:
    chunk_bytes = bytes.fromhex(hex_str)
    obfuscated_bytes += chunk_bytes

# Step 3: Convert the obfuscated bytes to a hex string
obfuscated_hex = obfuscated_bytes.hex()

# Step 4: Reverse the entire hex string to get the encrypted hex
encrypted_hex = obfuscated_hex[::-1]

# Step 5: Convert the encrypted hex to bytes (this is the OpenSSL encrypted data)
encrypted_bytes = bytes.fromhex(encrypted_hex)

# Now, encrypted_bytes contains the encrypted data
# Since we don't have the key and IV, we cannot decrypt it, but we can save it to a file
with open("encrypted_data.bin", "wb") as f:
    f.write(encrypted_bytes)

print("Encrypted data saved to encrypted_data.bin")
